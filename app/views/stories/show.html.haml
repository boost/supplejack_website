- title @story.name.truncate(40)
- content_for(:body_class) {'story'}


.container
	.story-header
		= attribute(@story.user_set, :name, label: false, tag: 'h1')
		%h3 
			By 
			= @story.user_set.user.try(:name)

		- unless @story.communities.empty?
			%h4 
				This story belongs to 
				- @story.communities.each do |community|
					•
					%span= link_to community, community


	%ul.tabs{ data: { tab: true } }
		%li.tab-title.active
			= link_to 'Story', '#story-panel'
		%li.tab-title
			= link_to 'Items in this set', '#items-panel'
		%li.tab-title
			= link_to 'Settings', '#settings-panel'

	
	

	.tabs-content
		#story-panel.content.active
			.freeform{ data: { editable: true, name: 'main' } }
				= @story.content_output
				

				/ = image_tag @records.first.large_thumbnail_url, class: 'full-width', 'data-ce-tag' => "static"


			/ %section.add-panel 
			/ 	%h3.add-message.toggle-add-panel Add to your story...			
			/ 	.add-panel-inset
			/ 		.container
			/ 			.row
			/ 				.medium-3.small-6.columns.item-adder
			/ 					%a.adder-icon.add-dnz{ data: {'reveal-id' => 'modal-add-to-dnz'} }
			/ 						= image_tag 'logo-dnz-sprout.png'
			/ 					item from digitalNZ
			/ 				.medium-3.small-6.columns.item-adder
			/ 					%a.adder-icon.add-image{ data: {'reveal-id' => 'modal-add-image'} }
			/ 						%i.fa.fa-camera-retro.fa-3x
			/ 					your own image
			/ 				.medium-3.small-6.columns.item-adder
			/ 					.adder-icon.add-text
			/ 						%i.fa.fa-font.fa-3x
			/ 					write something
			/ 				.medium-3.small-6.columns.item-adder
			/ 					.adder-icon.add-section
			/ 						%i.fa.fa-paragraph.fa-3x
			/ 					section break
			/ 	%span.add-icon.toggle-add-panel +

		#items-panel.content
			%h2 Items in this set
			%ul.medium-block-grid-3
				- @records.each do |record|
					%li= image_tag(record.image_url, data: { :'dnz-id' => record.id, :'ce-tag' => 'static' } )

		#settings-panel.content
			%h3 Communities

			%ul
				- Community.all.each do |community|
					%li
						- if @story.communities.include? community
							%strong= community
						- else
							= button_to community, add_community_to_story_path(@story, community.id)



#modal-add-to-dnz.reveal-modal{ 'data-reveal' => true, 'aria-labelledby' => "modalTitle", 'aria-hidden' => true,  role: 'dialog'}
	%h2 Search DigitalNZ for an item
	
	= render "shared/search"

	%h4 DigitalNZ suggests…
	%ul.small-block-grid-4.medium-block-grid-6
		- @story.suggested_images(6).each do |record|
			%li
				.block-image-wrapper= link_to image_tag(record.image_url), record_path(record.id)
				%cite
					%h6= raw(record.title)
					= record.display_content_partner
	= link_to raw('&#215;'), '#', class: 'close-reveal-modal', 'aria-label' => 'Close'


#modal-add-image.reveal-modal{ 'data-reveal' => true, 'aria-labelledby' => "modalTitle", 'aria-hidden' => true,  role: 'dialog'}
	%h2 Add your own image

	= link_to raw('&#215;'), '#', class: 'close-reveal-modal', 'aria-label' => 'Close'
